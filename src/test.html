<!DOCTYPE html>
<html lang="vi">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>YouTube Music - Style Player (Tailwind)</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
      /* thin top progress */
      .top-progress {
        height: 4px;
        border-radius: 999px;
      }
      input[type='range'] {
        -webkit-appearance: none;
        appearance: none;
        height: 8px;
        background: transparent;
      }
      input[type='range']::-webkit-slider-runnable-track {
        height: 8px;
        background: rgba(255, 255, 255, 0.08);
        border-radius: 999px;
      }
      input[type='range']::-webkit-slider-thumb {
        -webkit-appearance: none;
        width: 12px;
        height: 12px;
        margin-top: -2px;
        border-radius: 50%;
        background: white;
        box-shadow: 0 0 0 6px rgba(255, 255, 255, 0.06);
        cursor: pointer;
      }
      .track-art {
        background-size: cover;
        background-position: center;
      }
      .tiny {
        font-size: 12px;
      }
      /* make icons slightly transparent like YT Music */
      .muted-icon {
        opacity: 0.85;
      }
    </style>
  </head>
  <body class="bg-slate-900 text-white min-h-screen">
    <div class="p-6">
      <h2 class="text-xl font-semibold">Preview: YouTube Music-like Player</h2>
      <p class="text-slate-300 mt-2">
        Player cố định ở đáy — image thumbnail dùng file bạn upload.
      </p>
    </div>

    <!-- Fixed bottom player -->
    <div
      id="ytplayer"
      class="fixed bottom-0 left-0 right-0 bg-[#171717] border-t border-slate-800"
    >
      <!-- very thin top progress -->
      <div class="w-full">
        <div class="w-full bg-white/10">
          <div
            id="topProgress"
            class="top-progress bg-pink-500"
            style="width: 0%"
          ></div>
        </div>
      </div>

      <div class="max-w-6xl mx-auto flex items-center gap-4 py-3 px-4">
        <!-- Left controls -->
        <div class="flex items-center gap-4 min-w-[220px]">
          <div class="flex items-center gap-3">
            <button
              id="prev"
              class="w-9 h-9 flex items-center justify-center rounded hover:bg-white/6"
            >
              <!-- prev icon -->
              <svg
                xmlns="http://www.w3.org/2000/svg"
                class="w-5 h-5"
                viewBox="0 0 24 24"
                fill="currentColor"
              >
                <path d="M6.5 6.5v11l7-5.5-7-5.5zM17 6v12h2V6h-2z" />
              </svg>
            </button>

            <button
              id="play"
              class="w-11 h-11 flex items-center justify-center rounded-full bg-white text-black shadow-lg transform transition-transform hover:scale-105"
            >
              <!-- play symbol (toggles) -->
              <svg
                id="playIcon"
                xmlns="http://www.w3.org/2000/svg"
                class="w-6 h-6"
                viewBox="0 0 24 24"
                fill="currentColor"
              >
                <path d="M8 5v14l11-7z" />
              </svg>
              <svg
                id="pauseIcon"
                xmlns="http://www.w3.org/2000/svg"
                class="w-6 h-6 hidden"
                viewBox="0 0 24 24"
                fill="currentColor"
              >
                <path d="M6 5h4v14H6zM14 5h4v14h-4z" />
              </svg>
            </button>

            <button
              id="next"
              class="w-9 h-9 flex items-center justify-center rounded hover:bg-white/6"
            >
              <svg
                xmlns="http://www.w3.org/2000/svg"
                class="w-5 h-5"
                viewBox="0 0 24 24"
                fill="currentColor"
              >
                <path d="M15.5 6.5v11l-7-5.5 7-5.5zM19 6v12h2V6h-2z" />
              </svg>
            </button>
          </div>

          <div class="tiny text-slate-300"><span id="leftTime">0:00</span></div>
        </div>

        <!-- Center: thumbnail + meta (similar to screenshot) -->
        <div class="flex items-center gap-3 min-w-0">
          <div
            id="thumb"
            class="track-art w-14 h-14 rounded-sm shadow-sm"
            style="
              background-image: url('/mnt/data/9186c635-f79b-42b5-b8d5-72bbe2db7613.png');
            "
          ></div>
          <div class="min-w-0">
            <div id="trackTitle" class="font-semibold truncate">
              Người Tốt Nhất Cho Em
            </div>
            <div class="text-sm text-slate-400 truncate">
              Bon Nghiêm và 14 Casper · 170 N lượt xem · 2,7 N lượt thích
            </div>
          </div>

          <div class="flex items-center gap-3 ml-4">
            <button
              id="dislike"
              class="text-slate-300 hover:text-white muted-icon"
              title="Dislike"
            >
              <!-- thumbs down -->
              <svg
                xmlns="http://www.w3.org/2000/svg"
                class="w-5 h-5"
                viewBox="0 0 24 24"
                fill="currentColor"
              >
                <path d="M10 14h4v6h2V6h-2l-2.2 5H6v3l4 0z" />
              </svg>
            </button>
            <button
              id="like"
              class="text-slate-300 hover:text-white muted-icon"
              title="Like"
            >
              <svg
                xmlns="http://www.w3.org/2000/svg"
                class="w-5 h-5"
                viewBox="0 0 24 24"
                fill="currentColor"
              >
                <path
                  d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 6 3.79 4 6.2 4 7.97 4 9 5.22 9.54 6.09c.54-.87 1.57-2.09 3.36-2.09C14.21 4 16 6 16 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"
                />
              </svg>
            </button>
          </div>
        </div>

        <!-- Middle grow: progress and times (seekable) -->
        <div class="flex-1 px-6">
          <div class="flex items-center gap-3">
            <div
              class="text-xs text-slate-400 w-12 text-right"
              id="currentTime"
            >
              0:00
            </div>
            <div class="flex-1">
              <input id="progress" type="range" min="0" max="100" value="0" />
            </div>
            <div class="text-xs text-slate-400 w-12 text-left" id="totalTime">
              0:00
            </div>
          </div>
        </div>

        <!-- Right icons -->
        <div class="flex items-center gap-4 min-w-[260px] justify-end">
          <button
            id="volumeBtn"
            class="muted-icon hover:text-white"
            title="Volume"
          >
            <svg
              xmlns="http://www.w3.org/2000/svg"
              class="w-5 h-5"
              viewBox="0 0 24 24"
              fill="currentColor"
            >
              <path d="M3 9v6h4l5 5V4L7 9H3z" />
            </svg>
          </button>

          <div class="flex items-center gap-2">
            <button
              id="repeat"
              class="muted-icon hover:text-white"
              title="Repeat"
            >
              <svg
                xmlns="http://www.w3.org/2000/svg"
                class="w-5 h-5"
                viewBox="0 0 24 24"
                fill="currentColor"
              >
                <path
                  d="M7 7h10v3l4-4-4-4v3H7v2zm10 10H7v-3l-4 4 4 4v-3h10v-2z"
                />
              </svg>
            </button>
            <button
              id="shuffle"
              class="muted-icon hover:text-white"
              title="Shuffle"
            >
              <svg
                xmlns="http://www.w3.org/2000/svg"
                class="w-5 h-5"
                viewBox="0 0 24 24"
                fill="currentColor"
              >
                <path
                  d="M16 3h5v5l-2-2-3 3-1.5-1.5L18 6l-2-3zM3 6h2.6l6.9 6.9L11 14 5 8H3V6zm0 12h2v-2.6l6.9-6.9L13 6l-7 7V18z"
                />
              </svg>
            </button>
            <button
              id="queueToggle"
              class="muted-icon hover:text-white"
              title="Queue"
            >
              <svg
                xmlns="http://www.w3.org/2000/svg"
                class="w-5 h-5"
                viewBox="0 0 24 24"
                fill="currentColor"
              >
                <path
                  d="M3 13h14v-2H3v2zm0 4h14v-2H3v2zm0-8h14V7H3v2zM21 7v10l-2.5-1.5L16 17V7h5z"
                />
              </svg>
            </button>
          </div>
        </div>
      </div>

      <!-- Queue panel -->
      <div id="queuePanel" class="max-w-6xl mx-auto px-4 pb-3 hidden">
        <div class="bg-[#0f0f0f] rounded-md p-3">
          <div class="flex justify-between items-center mb-2">
            <div class="text-sm text-slate-300">Danh sách phát</div>
            <button id="closeQueue" class="text-slate-300">Đóng</button>
          </div>
          <ul id="queueList" class="space-y-2 max-h-48 overflow-auto pr-2"></ul>
        </div>
      </div>
    </div>

    <!-- Hidden audio -->
    <audio id="audio" preload="metadata"></audio>

    <script>
      // Playlist — thay url nếu bạn có file riêng
      const playlist = [
        {
          title: 'Người Tốt Nhất Cho Em',
          artist: 'Bon Nghiêm và 14 Casper',
          url: 'https://cdn.pixabay.com/download/audio/2022/03/15/audio_ba4e7a4df1.mp3?filename=relaxing-ambient-11552.mp3',
          art: '/mnt/data/9186c635-f79b-42b5-b8d5-72bbe2db7613.png',
        },
        // thêm track ở đây nếu cần
      ];

      // Elements
      const audio = document.getElementById('audio');
      const progress = document.getElementById('progress');
      const playBtn = document.getElementById('play');
      const playIcon = document.getElementById('playIcon');
      const pauseIcon = document.getElementById('pauseIcon');
      const prevBtn = document.getElementById('prev');
      const nextBtn = document.getElementById('next');
      const currentTimeEl = document.getElementById('currentTime');
      const totalTimeEl = document.getElementById('totalTime');
      const topProgress = document.getElementById('topProgress');
      const thumb = document.getElementById('thumb');
      const trackTitle = document.getElementById('trackTitle');
      const queueToggle = document.getElementById('queueToggle');
      const queuePanel = document.getElementById('queuePanel');
      const queueList = document.getElementById('queueList');
      const closeQueue = document.getElementById('closeQueue');
      const likeBtn = document.getElementById('like');
      const dislikeBtn = document.getElementById('dislike');
      const repeatBtn = document.getElementById('repeat');
      const shuffleBtn = document.getElementById('shuffle');

      let currentIndex = 0;
      let isPlaying = false;
      let isShuffle = false;
      let repeatMode = 'none';

      function loadTrack(i) {
        const t = playlist[i];
        audio.src = t.url;
        trackTitle.textContent = t.title;
        thumb.style.backgroundImage = `url('${t.art}')`;
        // reset
        progress.value = 0;
        currentTimeEl.textContent = '0:00';
        totalTimeEl.textContent = '0:00';
        updateTopProgress(0);
        highlightQueue();
      }

      function playAudio() {
        audio
          .play()
          .then(() => {
            isPlaying = true;
            playIcon.classList.add('hidden');
            pauseIcon.classList.remove('hidden');
          })
          .catch(e => console.warn('Autoplay blocked', e));
      }
      function pauseAudio() {
        audio.pause();
        isPlaying = false;
        playIcon.classList.remove('hidden');
        pauseIcon.classList.add('hidden');
      }

      playBtn.onclick = () => (isPlaying ? pauseAudio() : playAudio());

      prevBtn.onclick = () => {
        if (audio.currentTime > 3) {
          audio.currentTime = 0;
        } else {
          if (isShuffle)
            currentIndex = Math.floor(Math.random() * playlist.length);
          else
            currentIndex =
              (currentIndex - 1 + playlist.length) % playlist.length;
          loadTrack(currentIndex);
          playAudio();
        }
      };

      nextBtn.onclick = () => {
        if (isShuffle)
          currentIndex = Math.floor(Math.random() * playlist.length);
        else currentIndex = (currentIndex + 1) % playlist.length;
        loadTrack(currentIndex);
        playAudio();
      };

      audio.ontimeupdate = () => {
        if (audio.duration) {
          const pct = (audio.currentTime / audio.duration) * 100;
          progress.value = pct;
          updateTopProgress(pct);
          currentTimeEl.textContent = formatTime(audio.currentTime);
          totalTimeEl.textContent = formatTime(audio.duration);
        }
      };

      audio.onloadedmetadata = () => {
        totalTimeEl.textContent = formatTime(audio.duration || 0);
      };

      progress.oninput = e => {
        if (audio.duration) {
          audio.currentTime = (e.target.value / 100) * audio.duration;
        }
      };

      audio.onended = () => {
        if (repeatMode === 'one') {
          audio.currentTime = 0;
          playAudio();
        } else if (isShuffle) {
          currentIndex = Math.floor(Math.random() * playlist.length);
          loadTrack(currentIndex);
          playAudio();
        } else {
          if (currentIndex < playlist.length - 1) {
            currentIndex++;
            loadTrack(currentIndex);
            playAudio();
          } else {
            if (repeatMode === 'all') {
              currentIndex = 0;
              loadTrack(currentIndex);
              playAudio();
            } else {
              pauseAudio();
              audio.currentTime = 0;
            }
          }
        }
      };

      // small helpers
      function formatTime(s) {
        if (!s || isNaN(s)) return '0:00';
        const m = Math.floor(s / 60);
        const sec = Math.floor(s % 60)
          .toString()
          .padStart(2, '0');
        return `${m}:${sec}`;
      }

      function updateTopProgress(p) {
        topProgress.style.width = p + '%';
      }

      // Queue UI
      function buildQueue() {
        queueList.innerHTML = '';
        playlist.forEach((t, i) => {
          const li = document.createElement('li');
          li.className =
            'flex items-center justify-between p-2 rounded hover:bg-white/5 cursor-pointer';
          li.innerHTML = `
          <div class="flex items-center gap-3 min-w-0">
            <div class="w-10 h-10 rounded-sm bg-cover bg-center" style="background-image:url('${
              t.art
            }')"></div>
            <div class="min-w-0">
              <div class="truncate text-sm">${t.title}</div>
              <div class="text-xs text-slate-400 truncate">${
                t.artist || ''
              }</div>
            </div>
          </div>
          <div class="text-xs text-slate-400">▶</div>
        `;
          li.onclick = () => {
            currentIndex = i;
            loadTrack(i);
            playAudio();
          };
          queueList.appendChild(li);
        });
        highlightQueue();
      }

      function highlightQueue() {
        Array.from(queueList.children).forEach((el, i) => {
          el.classList.toggle('bg-white/6', i === currentIndex);
        });
      }

      queueToggle.onclick = () => queuePanel.classList.toggle('hidden');
      closeQueue.onclick = () => queuePanel.classList.add('hidden');

      // like/dislike toggle (visual only)
      likeBtn.onclick = () => likeBtn.classList.toggle('text-pink-500');
      dislikeBtn.onclick = () => dislikeBtn.classList.toggle('text-slate-100');

      // shuffle / repeat
      shuffleBtn.onclick = () => {
        isShuffle = !isShuffle;
        shuffleBtn.classList.toggle('text-pink-400', isShuffle);
      };
      repeatBtn.onclick = () => {
        if (repeatMode === 'none') repeatMode = 'all';
        else if (repeatMode === 'all') repeatMode = 'one';
        else repeatMode = 'none';
        repeatBtn.classList.toggle('text-pink-400', repeatMode !== 'none');
        repeatBtn.title = 'Repeat: ' + repeatMode;
      };

      // keyboard space to toggle
      window.addEventListener('keydown', e => {
        if (e.code === 'Space' && document.activeElement.tagName !== 'INPUT') {
          e.preventDefault();
          isPlaying ? pauseAudio() : playAudio();
        }
      });

      // init
      buildQueue();
      loadTrack(currentIndex);

      // try to load metadata on first click so duration appears (browsers often block autoplay)
      document.addEventListener('click', function first() {
        audio.load();
        document.removeEventListener('click', first);
      });
    </script>
  </body>
</html>
